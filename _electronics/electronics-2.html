---
title: "High Power DC Motor Driver using Relays and MOSFETs"
excerpt: "<br/><img src='/images/electronics/motor-driver-rm/board5.png'><br/> <small></small> "
collection: electronics
tags:
  - DC-motor-driver
  - relay-MOSFET-motor-driver
  - power-MOSFETs
  - PCB-design
  - EAGLE-PCB-software
---


<hr style="border-color: silver;">
<a href="https://github.com/GuruMulay/dc-motor-driver-relay-mosfet"><button type="button" class="btn btn--info"><i class="fa fa-github"></i> GitHub Source</button></a>
<br/>
<a href="https://cadlab.io/project/1369/master/files"><button type="button" class="btn btn--info"><i class="fa fa-object-group"></i> CadlabIO Source</button></a>
<hr style="border-color: silver;">


<!--##############-->
<!--<hr>-->
<p>
    <big>
    <b>Introduction:</b>
    </big>
</p>


<p>
    A motor driver consists of an H-bridge with a mechanism to control the speed of the motor.
    A basic H-bridge circuit is consist of four switches and a motor.
    For speed control one can use four MOSFETS as the switching devices to control the on and off time of the motor.
    Speed control is achieved by applying Pulse Width Modulated (PWM) signal to the Gate of the MOSFET.

    <br/>
    <br/>

    Relay-MOSFET driver in this project is a simple circuit in which the H-bridge was constructed using two
    electromagnetic relays (EMR) used as 4 switches.
    They were used to control the spinning direction of the motor.
    Now to control the speed, an N-channel MOSFET IRF460N was used for switching of the motor.
    PWM signal given to the GATE of this MOSFET controlled the on and off time of the MOSFET which in turn decides the
    amount of time for which current flows through the motor. A PWM of 50% duty time keeps the motor on for 50% of the
    times and thus making it spin at 50% of the speed it would achieve with a 100% duty cycle PWM signal.
    In this way by changing the duty cycle of the PWM signal, we can control the ON and OFF times of the motor.
    This MOSFET was required to carry large amounts of current hence a power MOSFET IRF460N was used.
    This motor driver was used in the Manual Robot that my robotics team designed for the robotics competition -
    Robocon 2012. The manual robot was required to be driven by a manual operator sitting on top of the robot.
    It was a enormous challenge to design a motor driver circuit that will withstand the high currents and high power
    required to carry our 65 Kg manual operator [PICTURE].

    <br/>
    <br/>

    Typical average on-load current for this driver was about 5-10 Amperes, and peak current would go up to 15-20 Amperes.
    For a circuit running at 24 V, these are really high current ratings.
    To put this in perspective, a typical average scale motor driver carries about 2 Amperes of continuous current on-load.
    On average the relay-MOSFET motor driver consumed 240 W power on-load.

</p>







<!--##############-->
<hr>
<p>
    <big>
    <b>Circuit Components:</b>
    </big>
</p>


<ul>

    <li><strong>Relays:</strong> Two 10A /24VDC relays were used as 4 switches for direction control.</li>

    <li><strong>ULN2003A IC:</strong> It is a Darlington pair IC. The current required to drive the coils of the relays
        was fulfilled by this Darlington pair IC.</li>

    <li><strong>MOSFET (IRF460N):</strong> This power MOSFET is capable of handling a large quantity of continuous
        currents and also its RDS(ON) is few milliohms, hence selected. Heat sink was also provided for proper heat
        decipitation.</li>

    <li><strong>Diodes:</strong> These are 2 freewheeling diodes used whenever freewheeling was required by the
        motor.</li>


</ul>




<!--##############-->
<hr>
<p>
    <big>
    <b>Printed Circuit Board:</b>
    </big>
</p>



<!--&lt;!&ndash;##############&ndash;&gt;-->
<!--<hr>-->
<!--<p>-->
    <!--<big>-->
    <!--<b>Cosine Distance between Attribute Vectors:</b>-->
    <!--</big>-->
<!--</p>-->

<!--<p>-->
    <!--After calculating the TF, IDF, and TF-IDF scores for set of books written by the same author (sub-collection)-->
    <!--in the corpus, we generate an <b> Author Attribute Vector (AAV) </b> as follows:-->

    <!--Every author will have their own AAV representing their unique writing style with the help of TF-IDF score of words-->
    <!--in the entire corpus. In order to find authorship of a unseen document, we compare the AAV of that document with-->
    <!--AAVs of all the possible authors. Note that to compare an arbitrary AAV (from the document with unknown authorship)-->
    <!--and existing AAVs, all of the AAVs must have the same dimension. For this comparison we calculate the <b>Cosine-->
    <!--Distance</b> between two AAVs that gives a measure of similarity between the authors’ writing styles.-->

    <!--Suppose that we have two authors with vectors, $AAV_1 = [x_1 , x_2 , ..., x_m]$ and $AAV_2 = [y_1 , y_2 , ..., y_m]$.-->
    <!--The Cosine Similarity between them is defined as,-->

<!--</p>-->

<!--<p style="text-align: center;">-->
    <!--&lt;!&ndash;<figure>&ndash;&gt;-->
    <!--<a href="/images/datascience/tfidf/cosine.jpg"><img src="/images/datascience/tfidf/cosine.jpg"></a>-->
    <!--<figcaption class="figure-caption text-center"><a href="https://en.wikipedia.org/wiki/Cosine_similarity" title="">Cosine similarity [Source: Wikipedia]</a></figcaption>-->
    <!--&lt;!&ndash;</figure>&ndash;&gt;-->
<!--</p>-->

<!--<p>-->
    <!--Where $AAV_1$ is represented by $A$ and $AAV_2$ by $B$. Using this formula, we will be able to create a ranked list-->
    <!--of potential authors for a given document with unknown authorship. Logically, the author with highest cosine-->
    <!--similarity with given document will be the most probable author of the document.-->
<!--</p>-->

<!--&lt;!&ndash;##############&ndash;&gt;-->
<!--<hr>-->
<!--<p>-->
    <!--<big>-->
    <!--<b>Dataset:</b>-->
    <!--</big>-->
<!--</p>-->

<!--<p>-->
    <!--Read <a href="/datascience/datascience-3/">the dataset description</a> from a previous post.-->
<!--</p>-->



<!--##############-->
<hr>
<p>
    <big>
    <b>Practical Performance:</b>
    </big>
</p>



<p>
At lower frequencies of PWM i.e. less than 8 KHz , MAXON R30 would respond to the PWM only after 10% duty cycle . At higher frequencies like 16 KHz or 32 KHz it would respond only after 30% duty cycle. This was probably because the response of the MOSFET at lower duty cycle was not good which would further worsened at higher frequencies.
LINEARITY: The response of motor to the PWM was not linear ; e.g. if 50% PWM is applied then ideally voltage across the motor should be 12 V , but practically it departed from this value .To achieve linearity a transistor was tried to control the GATE voltage .
Freewheeling diodes D1 and D2 can be connected whenever freewheeling is required and can be removed otherwise.
This driver was tested several times by drawing a current of about 5 to 6 A continuously for two hours. During this the MOSFET would show normal heating with heat sink.
When mounted on the manual machine and ridden a few times ,the ULN2003 was damaged through its ground pin. The same was noted when used for raising and lowering of jaws. Probable reason concluded was : Voltage fluctuations present in the GROND plane, produced by the motor were going directly to the GND pin of ULN and this damaged the IC.

Another version with DRAIN connected to Vcc was tried but as SOURCE was connected to the motor it went floating and the circuit couldn’t work.


Possible Improvements:
To avoid the damage to ULN, an inductor can be placed between power ground and ULN’s GND for isolation .
Further better MOSFETS can be used .
</p>




<!--<p>-->



<!--We use multiple Mappers and Reducers chained together (called job chaining) that produce intermediate results and-->
<!--then final results based on those intermediate results. Final output is a top-10 list of potential authors for the given-->
<!--document with unknown authorship. Part 1 and Part 2 is implemented-->
<!--<a href="https://github.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/tree/master/authorAttrVect">here</a>-->
<!--and Part 3 is implemented-->
<!--<a href="https://github.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/tree/master/cosineSimilarity">here</a>.-->

<!--</p>-->


<!--&lt;!&ndash;##############&ndash;&gt;-->
<!--<hr>-->
<!--<p>-->
    <!--<big>-->
    <!--<b>Outputs:</b>-->
    <!--</big>-->
<!--</p>-->

<!--Originally, we used the complete dataset as described above in the dataset section to found AAVs for all the authors in-->
<!--that dataset and then calculated their cosine similarity metric with AAV of the given document with unknown author.-->

<!--But for the purpose of illustration I will use a very small toy dataset containing 12 lines that can be found-->
<!--<a href="https://github.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/blob/master/authorAttrVect_toy_dataset_illustration/testData12.txt">here</a>.-->

<!--<br/>-->
<!--The-->
<!--<a href="https://github.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/blob/master/authorAttrVect_toy_dataset_illustration/">-->
    <!--<b>authorAttrVect_toy_dataset_illustration</b></a> direcory contains a very small toy dataset fed as input to the-->
<!--system and the outputs at every map reduce step of authorAttrVect map-reduce program from the repo.-->
<!--The final output is <i>mr4aav12.txt</i> that contains TF-IDF scores in the final column.-->


<!--&lt;!&ndash;Here are some snippets from the outputs of map reduce programs that gives AAV vectors for the authors from toy dataset.&ndash;&gt;-->
<!--Here is a snippet from the output of map-reduce described programs above.-->

<!--<br style="margin-bottom:10px;"/>-->
<!--<div style="text-align: center">-->
    <!--<a href="https://raw.githubusercontent.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/master/tfidf.jpg?token=AOOYCIfnE59APKitHCL5zO9s0beNAiWdks5bp_K1wA%3D%3D">-->
        <!--<img src="https://raw.githubusercontent.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/master/tfidf.jpg?token=AOOYCIfnE59APKitHCL5zO9s0beNAiWdks5bp_K1wA%3D%3D" alt="gutenberg ngram analysis using hadoop map-reduce" align="middle" hspace="30" height="350">-->
    <!--</a>-->

    <!--<br/>-->
    <!--<br/>-->
    <!--<figcaption>Fig. 1: TF-IDF scores for toy dataset (in final column)</figcaption>-->
<!--</div>-->
<!--<br/>-->


<!--Finally, we provide a document with unknown authorship to the <a href="https://github.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/tree/master/cosineSimilarity">-->
    <!--<b>cosineSimilarity</b></a> map-reduce program.  It produces the list of potential that are could have written that-->
<!--document. Suppose we fed a document written <i>twain</i> as a document with unknown authorship. The cosineSimilarity program-->
<!--will produce a list of potential authors like this one:-->


<!--<br style="margin-bottom:20px;"/>-->
<!--<p style="text-align: center;">-->
    <!--<a href="https://raw.githubusercontent.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/master/top-auth.jpg?token=AOOYCGdBUN-jbjInfJ8iqHLNmFksGktDks5bp_FdwA%3D%3D"><img src="https://raw.githubusercontent.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/master/top-auth.jpg?token=AOOYCGdBUN-jbjInfJ8iqHLNmFksGktDks5bp_FdwA%3D%3D"></a>-->
    <!--<figcaption class="figure-caption text-center">Fig. 2: Top authors for a document with unknown author</figcaption>-->
<!--</p>-->



<!--&lt;!&ndash;##############&ndash;&gt;-->
<!--<hr>-->
<!--<p>-->
    <!--<big>-->
    <!--<b>References:</b>-->
    <!--</big>-->
<!--</p>-->


<!--<ol type="1">-->
    <!--<li>https://en.wikipedia.org/wiki/N-gram</li>-->
    <!--<li>https://www.gutenberg.org</li>-->
<!--</ol>-->



<!--&lt;!&ndash;##############&ndash;&gt;-->
<!--<hr>-->
<!--<p>-->
    <!--<small>-->
    <!--<b>Note:</b>-->
    <!--Some of the content for this post is taken from course material of CS435 (CSU) written by Prof. Sangmi Lee Pallickara and GTAs.-->
    <!--</small>-->
<!--</p>-->
<!--<hr>-->