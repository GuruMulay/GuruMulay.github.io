---
title: "High Power DC Motor Driver using Relays and MOSFETs"
excerpt: "<br/><img src='/images/electronics/motor-driver-rm/board5.png'><br/> <small></small> "
collection: electronics
tags:
  - DC-motor-driver
  - relay-MOSFET-motor-driver
  - power-MOSFETs
  - PCB-design
  - EAGLE-PCB-software
---


<hr style="border-color: silver;">
<a href="https://github.com/GuruMulay/dc-motor-driver-relay-mosfet"><button type="button" class="btn btn--info"><i class="fa fa-github"></i> GitHub Source</button></a>
<br/>
<a href="https://cadlab.io/project/1369/master/files"><button type="button" class="btn btn--info"><i class="fa fa-object-group"></i> CadlabIO Source</button></a>
<hr style="border-color: silver;">


<!--##############-->
<!--<hr>-->
<p>
    <big>
    <b>Introduction:</b>
    </big>
</p>


<p>
    A motor driver consists of an H-bridge with added speed control mechanism.
    A basic H-bridge circuit is made up of four switches and a motor.
    For speed control one can use four MOSFETS as a switching device to control the on and off time of the motor.
    This can be achieved by applying PWM signal to the gate of the MOSFET.

    RELAY-MOSFET Driver in this project is a simple circuit in which the H-bridge was constructed using two
    electromagnetic relays (EMR) used as 4 switches.
    They were used to control the direction of the motor.
    Now to control the speed an N-channel MOSFET IRF460N was used for switching of motor.
    Pulse Width Modulated (PWM) signal was given to the GATE of this MOSFET.
    In this way by changing the duty cycle of the PWM signal, we can control the ON and OFF times of the motor.
    This MOSFET was required to carry large amounts of current hence a power MOSFET IRF460N was used.
    This motor driver was used in the Manual Robot that my robotics team designed for the robotics competition -
    Robocon 2012. The manual robot was required to be driven by a manual operator sitting on top of the robot.
    It was a enormous challenge to design a motor driver circuit that will withstand the high currents and high power
    required to carry our 65 Kg manual operator [PICTURE].

    Typical average current on-load for this driver was about 5-10 Amperes, and peak current would go up to 15-20 Amperes.
    For a circuit running at 24 V, these are really high current ratings.
    To put this in perspective, a typical average scale motor driver carries about 2 Ampere continuous current on-load.
    On average it consumed 240 W power on-load.

</p>







<!--##############-->
<hr>
<p>
    <big>
    <b>Circuit Components:</b>
    </big>
</p>



<p>

1. RELAYS :
Two 10A /24VDC relays were used as 4 switches for direction control.
2. ULN2003A :
It is a Darlington pair IC .The current requirement to drive the coils of relays was fulfilled by this Darlington pair IC.
3. MOSFET (IRF460N) :
This power MOSFET is capable of handling a large quantity of continuous current and also its RDS(ON) is few milliohms ,hence selected. Heat sink was also provided for heat decipitation .
4. DIODES :These are 2 freewheeling diodes used whenever freewheeling was required .


</p>


<!--<p>-->
    <!--<b>Term Frequency:</b>-->
<!--</p>-->

<!--<p>-->
    <!--Let's assume that we have a collection of documents written by M authors. This collection of documents may-->
    <!--contain multiple books written by an author. Let’s define a set of documents written by same author as-->
    <!--a sub-collection $j$. We define $f_{ij}$ to be the frequency (Number of occurrences) of term (word) $i$ in-->
    <!--sub-collection $j$.-->

    <!--<br/>-->
    <!--\begin{equation}-->
    <!--TF_{ij} = 0.5 +  {f_{ij} \over max_k f_{kj}}-->
    <!--\label{eq:tf1}-->
    <!--\end{equation}-->
    <!--<br/>-->

    <!--We use the augmented $TF$ (represented by 0.5 added initially in term 1 and then multiplied in terms 2 of-->
    <!--\eqref{eq:tf1}) to prevent a bias towards longer documents. Term 2 is the raw frequency divided by the-->
    <!--maximum raw frequency of any term $k$ in the sub-collection $j$. Stop words (e.g., a, an, the, etc) were-->
    <!--not eliminated from the corpus. The most frequent term in the sub-collection will have a augmented $TF$ value of 1.-->

<!--</p>-->



<!--<p>-->
    <!--<b>Inverse Document Frequency:</b>-->
<!--</p>-->


<!--<p>-->
    <!--Suppose that term $i$ appears in $n_i$ sub-collections within the corpus. For this assignment, we define the-->
    <!--$IDF_i$, as:-->

    <!--\begin{equation}-->
    <!--IDF_i = log_{10} ({N \over n_i})-->
    <!--\label{eq:idf1}-->
    <!--\end{equation}-->

    <!--where, $N$ is the total number of sub-collections (same as the number of authors).-->
<!--</p>-->


<!--<p>-->
    <!--<b>TF-IDF value:</b>-->
<!--</p>-->

<!--<p>-->
    <!--The TF-IDF score is the product - $TF_{ij}$ $\times$ $IDF_i$. The terms with the highest TF-IDF score are-->
    <!--considered the best words that characterize the sub-collection (document). They are the most important-->
    <!--attributes in the sub-collection's attribute vector.-->
<!--</p>-->



<!--&lt;!&ndash;##############&ndash;&gt;-->
<!--<hr>-->
<!--<p>-->
    <!--<big>-->
    <!--<b>Cosine Distance between Attribute Vectors:</b>-->
    <!--</big>-->
<!--</p>-->

<!--<p>-->
    <!--After calculating the TF, IDF, and TF-IDF scores for set of books written by the same author (sub-collection)-->
    <!--in the corpus, we generate an <b> Author Attribute Vector (AAV) </b> as follows:-->

    <!--Every author will have their own AAV representing their unique writing style with the help of TF-IDF score of words-->
    <!--in the entire corpus. In order to find authorship of a unseen document, we compare the AAV of that document with-->
    <!--AAVs of all the possible authors. Note that to compare an arbitrary AAV (from the document with unknown authorship)-->
    <!--and existing AAVs, all of the AAVs must have the same dimension. For this comparison we calculate the <b>Cosine-->
    <!--Distance</b> between two AAVs that gives a measure of similarity between the authors’ writing styles.-->

    <!--Suppose that we have two authors with vectors, $AAV_1 = [x_1 , x_2 , ..., x_m]$ and $AAV_2 = [y_1 , y_2 , ..., y_m]$.-->
    <!--The Cosine Similarity between them is defined as,-->

<!--</p>-->

<!--<p style="text-align: center;">-->
    <!--&lt;!&ndash;<figure>&ndash;&gt;-->
    <!--<a href="/images/datascience/tfidf/cosine.jpg"><img src="/images/datascience/tfidf/cosine.jpg"></a>-->
    <!--<figcaption class="figure-caption text-center"><a href="https://en.wikipedia.org/wiki/Cosine_similarity" title="">Cosine similarity [Source: Wikipedia]</a></figcaption>-->
    <!--&lt;!&ndash;</figure>&ndash;&gt;-->
<!--</p>-->

<!--<p>-->
    <!--Where $AAV_1$ is represented by $A$ and $AAV_2$ by $B$. Using this formula, we will be able to create a ranked list-->
    <!--of potential authors for a given document with unknown authorship. Logically, the author with highest cosine-->
    <!--similarity with given document will be the most probable author of the document.-->
<!--</p>-->

<!--&lt;!&ndash;##############&ndash;&gt;-->
<!--<hr>-->
<!--<p>-->
    <!--<big>-->
    <!--<b>Dataset:</b>-->
    <!--</big>-->
<!--</p>-->

<!--<p>-->
    <!--Read <a href="/datascience/datascience-3/">the dataset description</a> from a previous post.-->
<!--</p>-->



<!--##############-->
<hr>
<p>
    <big>
    <b>Practical Performance:</b>
    </big>
</p>



<p>
At lower frequencies of PWM i.e. less than 8 KHz , MAXON R30 would respond to the PWM only after 10% duty cycle . At higher frequencies like 16 KHz or 32 KHz it would respond only after 30% duty cycle. This was probably because the response of the MOSFET at lower duty cycle was not good which would further worsened at higher frequencies.
LINEARITY: The response of motor to the PWM was not linear ; e.g. if 50% PWM is applied then ideally voltage across the motor should be 12 V , but practically it departed from this value .To achieve linearity a transistor was tried to control the GATE voltage .
Freewheeling diodes D1 and D2 can be connected whenever freewheeling is required and can be removed otherwise.
This driver was tested several times by drawing a current of about 5 to 6 A continuously for two hours. During this the MOSFET would show normal heating with heat sink.
When mounted on the manual machine and ridden a few times ,the ULN2003 was damaged through its ground pin. The same was noted when used for raising and lowering of jaws. Probable reason concluded was : Voltage fluctuations present in the GROND plane, produced by the motor were going directly to the GND pin of ULN and this damaged the IC.

Another version with DRAIN connected to Vcc was tried but as SOURCE was connected to the motor it went floating and the circuit couldn’t work.


Possible Improvements:
To avoid the damage to ULN, an inductor can be placed between power ground and ULN’s GND for isolation .
Further better MOSFETS can be used .
</p>




<!--<p>-->

<!--<ul>-->

    <!--<li><strong>Part 1:</strong> Calculate the TF, IDF, and TF-IDF values for all terms for all of the sub-collections-->
        <!--in the corpus.</li>-->

    <!--<li><strong>Part 2:</strong> Create the AAVs (author attribute vectors) for every author.</li>-->

    <!--<li><strong>Part 3:</strong> Find cosine similarity between AAV of given document with unknown author and all the-->
        <!--authors in the corpus.</li>-->

<!--</ul>-->


<!--We use multiple Mappers and Reducers chained together (called job chaining) that produce intermediate results and-->
<!--then final results based on those intermediate results. Final output is a top-10 list of potential authors for the given-->
<!--document with unknown authorship. Part 1 and Part 2 is implemented-->
<!--<a href="https://github.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/tree/master/authorAttrVect">here</a>-->
<!--and Part 3 is implemented-->
<!--<a href="https://github.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/tree/master/cosineSimilarity">here</a>.-->

<!--</p>-->


<!--&lt;!&ndash;##############&ndash;&gt;-->
<!--<hr>-->
<!--<p>-->
    <!--<big>-->
    <!--<b>Outputs:</b>-->
    <!--</big>-->
<!--</p>-->

<!--Originally, we used the complete dataset as described above in the dataset section to found AAVs for all the authors in-->
<!--that dataset and then calculated their cosine similarity metric with AAV of the given document with unknown author.-->

<!--But for the purpose of illustration I will use a very small toy dataset containing 12 lines that can be found-->
<!--<a href="https://github.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/blob/master/authorAttrVect_toy_dataset_illustration/testData12.txt">here</a>.-->

<!--<br/>-->
<!--The-->
<!--<a href="https://github.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/blob/master/authorAttrVect_toy_dataset_illustration/">-->
    <!--<b>authorAttrVect_toy_dataset_illustration</b></a> direcory contains a very small toy dataset fed as input to the-->
<!--system and the outputs at every map reduce step of authorAttrVect map-reduce program from the repo.-->
<!--The final output is <i>mr4aav12.txt</i> that contains TF-IDF scores in the final column.-->


<!--&lt;!&ndash;Here are some snippets from the outputs of map reduce programs that gives AAV vectors for the authors from toy dataset.&ndash;&gt;-->
<!--Here is a snippet from the output of map-reduce described programs above.-->

<!--<br style="margin-bottom:10px;"/>-->
<!--<div style="text-align: center">-->
    <!--<a href="https://raw.githubusercontent.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/master/tfidf.jpg?token=AOOYCIfnE59APKitHCL5zO9s0beNAiWdks5bp_K1wA%3D%3D">-->
        <!--<img src="https://raw.githubusercontent.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/master/tfidf.jpg?token=AOOYCIfnE59APKitHCL5zO9s0beNAiWdks5bp_K1wA%3D%3D" alt="gutenberg ngram analysis using hadoop map-reduce" align="middle" hspace="30" height="350">-->
    <!--</a>-->

    <!--<br/>-->
    <!--<br/>-->
    <!--<figcaption>Fig. 1: TF-IDF scores for toy dataset (in final column)</figcaption>-->
<!--</div>-->
<!--<br/>-->


<!--Finally, we provide a document with unknown authorship to the <a href="https://github.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/tree/master/cosineSimilarity">-->
    <!--<b>cosineSimilarity</b></a> map-reduce program.  It produces the list of potential that are could have written that-->
<!--document. Suppose we fed a document written <i>twain</i> as a document with unknown authorship. The cosineSimilarity program-->
<!--will produce a list of potential authors like this one:-->


<!--<br style="margin-bottom:20px;"/>-->
<!--<p style="text-align: center;">-->
    <!--<a href="https://raw.githubusercontent.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/master/top-auth.jpg?token=AOOYCGdBUN-jbjInfJ8iqHLNmFksGktDks5bp_FdwA%3D%3D"><img src="https://raw.githubusercontent.com/GuruMulay/content-based-authorship-detection-using-tfidf-score/master/top-auth.jpg?token=AOOYCGdBUN-jbjInfJ8iqHLNmFksGktDks5bp_FdwA%3D%3D"></a>-->
    <!--<figcaption class="figure-caption text-center">Fig. 2: Top authors for a document with unknown author</figcaption>-->
<!--</p>-->



<!--&lt;!&ndash;&lt;!&ndash;##############&ndash;&gt;&ndash;&gt;-->
<!--&lt;!&ndash;<hr>&ndash;&gt;-->
<!--&lt;!&ndash;<p>&ndash;&gt;-->
    <!--&lt;!&ndash;<big>&ndash;&gt;-->
    <!--&lt;!&ndash;<b>References:</b>&ndash;&gt;-->
    <!--&lt;!&ndash;</big>&ndash;&gt;-->
<!--&lt;!&ndash;</p>&ndash;&gt;-->


<!--&lt;!&ndash;<ol type="1">&ndash;&gt;-->
    <!--&lt;!&ndash;<li>https://en.wikipedia.org/wiki/N-gram</li>&ndash;&gt;-->
    <!--&lt;!&ndash;<li>https://www.gutenberg.org</li>&ndash;&gt;-->
<!--&lt;!&ndash;</ol>&ndash;&gt;-->



<!--&lt;!&ndash;##############&ndash;&gt;-->
<!--<hr>-->
<!--<p>-->
    <!--<small>-->
    <!--<b>Note:</b>-->
    <!--Some of the content for this post is taken from course material of CS435 (CSU) written by Prof. Sangmi Lee Pallickara and GTAs.-->
    <!--</small>-->
<!--</p>-->
<!--<hr>-->